import{c as p,j as e,B as g,L as h,d as N,r as m,s as x}from"./index-CFiATYwG.js";import{D as j,f as w,g as y,j as b,h as L,i as v}from"./sign-out-dialog-CdNQkXpx.js";import{M as C}from"./menu-7sfJY0Es.js";import{B as k}from"./badge-CpQE5GvW.js";import{g as M,b as P,u as _,s as B}from"./translations-ArtDJxZd.js";import{Z as D}from"./zap-gA41c9Qf.js";import{C as E}from"./check-BepUPVCN.js";const z=[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]],S=p("building-2",z);const $=[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]],F=p("crown",$);const R=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],I=p("globe",R);function G({className:o,links:c,...i}){return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"lg:hidden",children:e.jsxs(j,{modal:!1,children:[e.jsx(w,{asChild:!0,children:e.jsx(g,{size:"icon",variant:"outline",className:"md:size-7",children:e.jsx(C,{className:"h-4 w-4"})})}),e.jsx(y,{side:"bottom",align:"start",children:c.map(({title:a,href:n,isActive:r,disabled:t})=>e.jsx(b,{asChild:!0,children:e.jsx(h,{to:n,className:r?"":"text-muted-foreground",disabled:t,children:a})},`${a}-${n}`))})]})}),e.jsx("nav",{className:N("hidden items-center space-x-4 lg:flex lg:space-x-4 xl:space-x-6",o),...i,children:c.map(({title:a,href:n,isActive:r,disabled:t})=>e.jsx(h,{to:n,disabled:t,className:`hover:text-primary text-sm font-medium transition-colors ${r?"":"text-muted-foreground"}`,children:a},`${a}-${n}`))})]})}function A(){const[o,c]=m.useState(null),[i,a]=m.useState(!0),n=m.useRef(!1);return m.useEffect(()=>{if(n.current)return;(async()=>{n.current=!0;try{const t=M();if(!t){a(!1);return}let d=null,l=null;try{const s=await x.rpc("get_customer_plan",{p_customer_id:t});d=s.data,l=s.error,l&&(console.warn("RPC returned error (non-critical), using fallback:",l.code||l.message),l={...l,code:"FALLBACK"})}catch(s){console.warn("RPC call threw an error (non-critical):",s?.message||s),l={code:"FALLBACK",message:s?.message||"RPC call failed"}}if(l||!d){try{const{data:s,error:u}=await x.from("customers").select("plan").eq("id",t).maybeSingle();if(!u&&s?.plan){const f=s.plan.toLowerCase().trim();["basic","pro","entreprise"].includes(f)&&c(f)}else u&&console.warn("Fallback query also failed (non-critical):",u.code||u.message)}catch(s){console.warn("Fallback query threw error (non-critical):",s?.message||s)}a(!1);return}if(d&&typeof d=="string"){const s=d.toLowerCase().trim();["basic","pro","entreprise"].includes(s)&&c(s)}}catch(t){console.warn("Error fetching customer plan (non-critical, safely handled):",t?.message||t)}finally{a(!1)}})()},[]),{plan:o,loading:i}}function J(){const{plan:o,loading:c}=A();if(c||!o)return null;const a={basic:{label:"Basic",variant:"secondary",icon:D},pro:{label:"Pro",variant:"default",icon:F},entreprise:{label:"Entreprise",variant:"default",icon:S}}[o];if(!a)return null;const n={basic:300,pro:1e3,entreprise:2500},r=a.icon;return e.jsxs(k,{variant:a.variant,className:"flex items-center gap-2 px-2.5 py-1",children:[e.jsx(r,{className:"h-4 w-4"}),e.jsxs("span",{className:"text-xs font-medium",children:[a.label," Â· ",n[o]," min"]})]})}function Q(){const{currentLanguage:o,setLanguage:c}=P(),i=_(),[a,n]=m.useState(!1);return e.jsxs(j,{open:a,onOpenChange:n,children:[e.jsx(w,{asChild:!0,children:e.jsx(g,{variant:"outline",size:"icon",className:"h-8 w-8","aria-label":i.common.selectLanguage,children:e.jsx(I,{className:"h-4 w-4"})})}),e.jsxs(y,{align:"end",className:"w-56",children:[e.jsx(L,{children:i.common.selectLanguage}),e.jsx(v,{}),e.jsx("div",{className:"max-h-[300px] overflow-y-auto",children:B.map(r=>e.jsxs(b,{onClick:()=>{c(r.code),n(!1)},className:"flex items-center justify-between cursor-pointer",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xl",children:r.flag}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-medium",children:r.name}),e.jsx("span",{className:"text-xs text-muted-foreground",children:r.nativeName})]})]}),o.code===r.code&&e.jsx(E,{className:"h-4 w-4 text-primary"})]},r.code))})]})]})}export{Q as L,J as P,G as T,A as u};
